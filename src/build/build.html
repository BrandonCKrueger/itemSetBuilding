<section class="container build">
    <h2>Build</h2>
    <div class="row">
        <div class="col-md-6 item-build">
            <div class="row item-build-details">
                <div class="col-xs-12 col-sm-6">
                    <label>Title: </label>
                    <span ng-bind="buildVm.itemSet.title"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Type: </label>
                    <span ng-bind="buildVm.itemSet.type" style="text-transform: capitalize;"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Priority: </label>
                    <span ng-if="!buildVm.itemSet.priority">No</span>
                    <span ng-if="buildVm.itemSet.priority">Yes</span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Sort Rank: </label>
                    <span ng-bind="buildVm.itemSet.sortrank"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Mode: </label>
                    <span ng-if="buildVm.itemSet.mode === 'any'">All Modes</span>
                    <span ng-if="buildVm.itemSet.mode === 'CLASSIC'">Classic</span>
                    <span ng-if="buildVm.itemSet.mode === 'ARAM'">ARAM</span>
                    <span ng-if="buildVm.itemSet.mode === 'ODIN'">Dominion</span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Map: </label>
                    <span ng-if="buildVm.itemSet.map === 'any'">All Maps</span>
                    <span ng-if="buildVm.itemSet.map === 'SR'">Summoners Rift</span>
                    <span ng-if="buildVm.itemSet.map === 'TT'">Twisted Treeline</span>
                    <span ng-if="buildVm.itemSet.map === 'CS'">Crystal Score</span>
                    <span ng-if="buildVm.itemSet.map === 'HA'">Howling Abyss</span>
                </div>
                <i class="fa fa-cog" ng-click="buildVm.editDetails = true;"></i>
            </div>

            <div class="item-build-block" ng-repeat="block in buildVm.itemSet.blocks">
                <header>
                    <input type="text" placeholder="Block Name" ng-model="block.type" />
                    <div class="btn btn-default rec-math pull-right"
                         ng-class="{'btn-success': block.recMath}"
                         ng-click="block.recMath = !block.recMath">
                        Rec Math: On
                    </div>
                </header>
                <section data-drop="true"
                         data-jqyoui-options
                         jqyoui-droppable="{
                            beforeDrop: 'buildVm.addItemToBlock(block)'
                         }">
                    <ul ui-sortable ng-model="block.items">
                        <li ng-repeat="item in block.items track by $index">
                            <div class="item">
                                <img ng-src="//lkimg.zamimg.com/images/v2/items/icons/size64x64/{{buildVm.items[item.id].id}}.png" />
                                <span class="item-info" ng-bind="buildVm.items[item.id].name"></span>
                                <div class="rec-math" ng-if="block.recMath && !$first">
                                    <i class="fa" ng-class="{'fa-arrow-right': $last, 'fa-plus': !$last}"></i>
                                </div>
                                <div class="btn btn-default quantity">
                                    <i class="fa fa-minus" ng-click="buildVm.updateCount(item,-1)" ng-class="{'disabled': item.count <= 1}"></i>
                                    <span ng-bind="item.count"></span>
                                    <i class="fa fa-plus" ng-click="buildVm.updateCount(item,1)" ng-class="{'disabled': item.count >= 999}"></i>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <ul>
                        <li>
                            <div class="add-item" ng-if="block.items.length < 6">
                                <i class="fa fa-plus"></i>
                            </div>
                        </li>
                    </ul>
                    
                    <div style="clear: both;"></div>
                </section>
                <section class="restrictions">
                    <header>
                        <h5>
                            <i class="fa fa-cog" ng-click="buildVm.editBlock(block, $event);"></i>
                            Restrictions
                        </h5>
                    </header>
                    <div class="summonerLevel">
                        <label>Summoner Level: </label>
                        <span ng-bind="buildVm.summonerLevelRange(block)"></span>
                    </div>
                    <div class="summonerSpells" ng-if="block.showIfSummonerSpell.length > 0 || block.hideIfSummonerSpell.length > 0">
                        <div ng-if="block.showIfSummonerSpell.length > 0">
                            <label>Show if Summoner has spell: </label>
                            <span ng-bind="block.showIfSummonerSpell"></span>
                        </div>
                        <div ng-if="block.hideIfSummonerSpell.length > 0">
                            <label>Hide if Summoner has spell: </label>
                            <span ng-bind="block.hideIfSummonerSpell"></span>
                        </div>
                    </div>
                </section>
            </div>
            <div class="add-item-block" ng-click="buildVm.addBlock()">
                <i class="fa fa-plus"></i>
                <span> Add Block</span>
            </div>
        </div>

        <div class="col-md-6 item-list">
            <header class="row">
                Item filter...
            </header>
            <div class="row">
                <div class="item"
                     ng-repeat="(itemId, itemData) in buildVm.items"
                     data-drag="true"
                     data-jqyoui-options="{revert: 'invalid'}"
                     jqyoui-draggable="{animate:true, placeholder:true}"
                     data-item-id="{{itemId}}">
                    <img src="//lkimg.zamimg.com/images/v2/items/icons/size64x64/3001.png2" />
                    <span class="item-info" ng-bind="itemData.name"></span>
                </div>
            </div>
        </div>
    </div>
</section>

<edit-build-details class="edit-build-details"
                    item-set="buildVm.itemSet"
                    modal-state="buildVm.editDetails"
                    ng-if="buildVm.editDetails"
                    ng-animate="'animate'"></edit-build-details>

<edit-block-details class="edit-block-details"
                    block="buildVm.blockToEdit"
                    modal-state="buildVm.editBlockDetails"
                    ng-if="buildVm.editBlockDetails"
                    ng-animate="'animate'"></edit-block-details>