<section class="container build">
    <div class="row">
        <div class="col-xs-12 item-build">
            <div class="row item-build-details">
                <div class="col-xs-12 col-sm-6">
                    <label>Title: </label>
                    <span ng-bind="buildVm.itemSet.title"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Type: </label>
                    <span ng-bind="buildVm.itemSet.type" style="text-transform: capitalize;"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Priority: </label>
                    <span ng-if="!buildVm.itemSet.priority">No</span>
                    <span ng-if="buildVm.itemSet.priority">Yes</span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Sort Rank: </label>
                    <span ng-bind="buildVm.itemSet.sortrank"></span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Mode: </label>
                    <span ng-if="buildVm.itemSet.mode === 'any'">All Modes</span>
                    <span ng-if="buildVm.itemSet.mode === 'CLASSIC'">Classic</span>
                    <span ng-if="buildVm.itemSet.mode === 'ARAM'">ARAM</span>
                    <span ng-if="buildVm.itemSet.mode === 'ODIN'">Dominion</span>
                </div>
                <div class="col-xs-12 col-sm-6">
                    <label>Map: </label>
                    <span ng-if="buildVm.itemSet.map === 'any'">All Maps</span>
                    <span ng-if="buildVm.itemSet.map === 'SR'">Summoners Rift</span>
                    <span ng-if="buildVm.itemSet.map === 'TT'">Twisted Treeline</span>
                    <span ng-if="buildVm.itemSet.map === 'CS'">Crystal Score</span>
                    <span ng-if="buildVm.itemSet.map === 'HA'">Howling Abyss</span>
                </div>
                <i class="fa fa-cog"
                   ng-click="buildVm.editDetails = true;"
                   ng-if="buildVm.itemSet.editable"></i>
            </div>

            <div class="item-build-block" ng-repeat="block in buildVm.itemSet.blocks">
                <header>
                    <input type="text" placeholder="Block Name" ng-model="block.type" ng-if="buildVm.itemSet.editable" />
                    <strong ng-bind="block.type" ng-if="!buildVm.itemSet.editable"></strong>
                    <div class="btn btn-default rec-math pull-right"
                         ng-class="{'btn-success': block.recMath}"
                         ng-click="block.recMath = !block.recMath"
                         ng-if="buildVm.itemSet.editable">
                        Rec Math: On
                    </div>
                </header>
                <section data-drop="true"
                         data-jqyoui-options
                         jqyoui-droppable="{
                            beforeDrop: 'buildVm.addItemToBlock(block)'
                         }">
                    <ul ui-sortable ng-model="block.items">
                        <li ng-repeat="item in block.items track by $index">
                            <div class="item">
                                <img ng-src="//lkimg.zamimg.com/images/v2/items/icons/size64x64/{{item.id}}.png" />
                                <span class="item-info" ng-bind="buildVm.items[item.id].name"></span>
                                <div class="rec-math" ng-if="block.recMath && !$first">
                                    <i class="fa" ng-class="{'fa-arrow-right': $last, 'fa-plus': !$last}"></i>
                                </div>
                                <div class="btn btn-default quantity">
                                    <i class="fa fa-minus"
                                       ng-click="buildVm.updateCount(item,-1)"
                                       ng-class="{'disabled': item.count <= 1}"
                                       ng-if="buildVm.itemSet.editable"></i>
                                    <span ng-bind="item.count"></span>
                                    <i class="fa fa-plus"
                                       ng-click="buildVm.updateCount(item,1)"
                                       ng-class="{'disabled': item.count >= 999}"
                                       ng-if="buildVm.itemSet.editable"></i>
                                </div>
                                <i class="fa fa-times" ng-click="buildVm.removeItemFromBlock(item, block)"></i>
                            </div>
                        </li>
                    </ul>
                    <ul ng-if="buildVm.itemSet.editable">
                        <li>
                            <div class="add-item"
                                 ng-if="block.items.length < 6"
                                 ng-click="buildVm.addItemToBlock(block)">
                                <i class="fa fa-plus"></i>
                            </div>
                        </li>
                    </ul>
                    
                    <div style="clear: both;"></div>
                </section>
                <section class="restrictions">
                    <header>
                        <h5>
                            <i class="fa fa-cog"
                               ng-click="buildVm.editBlock(block, $event);"
                               ng-if="buildVm.itemSet.editable"></i>
                            Restrictions
                        </h5>
                    </header>
                    <div class="summonerLevel">
                        <label>Summoner Level: </label>
                        <span ng-bind="buildVm.summonerLevelRange(block)"></span>
                    </div>
                    <div class="summonerSpells" ng-if="block.showIfSummonerSpell.length > 0 || block.hideIfSummonerSpell.length > 0">
                        <div ng-if="block.showIfSummonerSpell.length > 0">
                            <label>Show if Summoner has spell: </label>
                            <span ng-bind="block.showIfSummonerSpell"></span>
                        </div>
                        <div ng-if="block.hideIfSummonerSpell.length > 0">
                            <label>Hide if Summoner has spell: </label>
                            <span ng-bind="block.hideIfSummonerSpell"></span>
                        </div>
                    </div>
                </section>
            </div>
            <div class="add-item-block" ng-click="buildVm.addBlock()" ng-if="buildVm.itemSet.editable">
                <i class="fa fa-plus"></i>
                <span> Add Block</span>
            </div>
        </div>
        
        <div class="col-md-6 col-xs-12" ng-if="!buildVm.itemSet.editable">
            <header class="row">
                Related Builds
            </header>
        </div>
    </div>
</section>

<edit-build-details class="edit-build-details"
                    item-set="buildVm.itemSet"
                    modal-state="buildVm.editDetails"
                    ng-if="buildVm.editDetails"
                    ng-animate="'animate'"></edit-build-details>

<edit-block-details class="edit-block-details"
                    block="buildVm.blockToEdit"
                    modal-state="buildVm.editBlockDetails"
                    ng-if="buildVm.editBlockDetails"
                    ng-animate="'animate'"></edit-block-details>
                    
<item-list class="item-list"
           block-to-add-item-to="buildVm.blockToAddItemTo"
           modal-state="buildVm.showItemList"
           ng-if="buildVm.showItemList"
           ng-animate="'animate'"></item-list>